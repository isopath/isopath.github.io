<!doctype html><html lang=en dir=auto data-theme=dark><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>My new name is... Rain Man | isopath</title>
<meta name=keywords content><meta name=description content="Building a Matrix rain effect in the terminal using Go and Bubble Tea"><meta name=author content><link rel=canonical href=https://isopath.github.io/posts/matrix-go/><link crossorigin=anonymous href=/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css integrity="sha256-2jIR5e+Ge/K3X9WmUVz+1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as=style><link rel=icon href=https://isopath.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://isopath.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://isopath.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://isopath.github.io/apple-touch-icon.png><link rel=mask-icon href=https://isopath.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://isopath.github.io/posts/matrix-go/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="https://isopath.github.io/posts/matrix-go/"><meta property="og:site_name" content="isopath"><meta property="og:title" content="My new name is... Rain Man"><meta property="og:description" content="Building a Matrix rain effect in the terminal using Go and Bubble Tea"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-13T00:00:00+00:00"><meta property="article:modified_time" content="2025-02-13T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="My new name is... Rain Man"><meta name=twitter:description content="Building a Matrix rain effect in the terminal using Go and Bubble Tea"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://isopath.github.io/posts/"},{"@type":"ListItem","position":2,"name":"My new name is... Rain Man","item":"https://isopath.github.io/posts/matrix-go/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"My new name is... Rain Man","name":"My new name is... Rain Man","description":"Building a Matrix rain effect in the terminal using Go and Bubble Tea","keywords":[],"articleBody":"\nWe got bored one weekend and decided to build a Matrix rain effect in the terminal. You know, those cascading green characters from the movie? But we wanted ours to display actual text files, not just random symbols. Here’s how we built it.\nThe Problem with Shipping Assets Building a terminal app is easy until you need to include data files. We had a bunch of text files we wanted to display, but asking users to download separate assets felt wrong. What if they put them in the wrong folder? What if they forgot entirely?\nGo’s //go:embed directive solves this beautifully. It lets you embed files directly into the compiled binary. No external dependencies, no “file not found” errors.\n//go:embed assets/*.txt var assetsFS embed.FS func readAsset(filename string) (string, error) { data, err := assetsFS.ReadFile(filename) if err != nil { return \"\", err } return string(data), nil } Now our single binary contains everything. Ship it, run it, done.\nBuilding a Menu That Doesn’t Suck We wanted users to pick which text file to rain-ify. Bubble Tea (Charm’s TUI framework) makes this possible, but it’s not exactly plug-and-play. The API requires you to jump through some hoops.\nFirst, every list item needs to implement the list.Item interface. Go is strict about this - even if you don’t use a feature, you still need to satisfy the interface:\ntype item struct { title string filename string } // Required by list.Item, even though we disable filtering func (i item) FilterValue() string { return \"\" } Then there’s the delegate - the thing that actually renders each item. This is where you customize the look:\ntype itemDelegate struct{} func (d itemDelegate) Render(w io.Writer, m list.Model, index int, listItem list.Item) { i, ok := listItem.(item) if !ok { return // Trust but verify } str := fmt.Sprintf(\"%d. %s\", index+1, i.title) if index == m.Index() { fmt.Fprint(w, selectedItemStyle.Render(\"\u003e \"+str)) } else { fmt.Fprint(w, itemStyle.Render(str)) } } The type assertion i, ok := listItem.(item) is Go’s way of saying “I know what this should be, but prove it.” It’s defensive programming that prevents panics when types don’t match.\nThe Heartbeat of Animation Bubble Tea uses the Elm Architecture: your app has a Model (state), an Update function (handles messages), and a View function (renders output). Everything flows through messages.\nFor animation, we needed a timer. Enter tea.Tick:\nfunc tick() tea.Cmd { return tea.Tick(time.Millisecond*80, func(t time.Time) tea.Msg { return tickMsg(t) }) } Every 80 milliseconds, this fires a message. Why 80ms? We tried 16ms (60fps) first, but the laptop fan sounded like a jet engine. 80ms is smooth enough to look good without melting your CPU.\nThe Update function catches these ticks and advances the animation:\nfunc (m model) Update(msg tea.Msg) (tea.Model, tea.Cmd) { switch msg := msg.(type) { case tickMsg: if m.viewing { m.updateColumns() // Move the rain return m, tick() // Schedule next frame } } // ... handle other messages } Notice how tick() returns itself? That’s the recursive heartbeat. Each frame schedules the next one. Elegant once you wrap your head around it.\nMaking It Rain The actual rain effect works by creating vertical columns of characters. Each column has a position, a height, and an offset into the source text:\ntype column struct { x int // horizontal position height int // how many characters offset int // position in source text } We calculate how many columns fit on screen (one every 2 characters for spacing), then randomize their starting positions:\nnumCols := m.width / 2 m.columns = make([]column, numCols) for i := range m.columns { m.columns[i] = column{ x: i * 2, height: rand.Intn(m.height) + 5, offset: rand.Intn(len(runes)), } } Each frame, every column increments its offset. When it reaches the end of the text, it wraps back to zero. That’s what creates the infinite scrolling effect. We also randomize heights occasionally - real rain isn’t uniform, and neither should this be.\nThe View from Above Rendering is the fun part. We build a 2D grid representing the terminal screen, fill it with spaces, then paint our rain columns:\ngrid := make([][]rune, m.height) for i := range grid { grid[i] = make([]rune, m.width) for j := range grid[i] { grid[i][j] = ' ' } } Then we iterate through columns and place characters. The math (col.offset + row) % len(runes) wraps the text index so columns seamlessly loop through the content.\nFinally, we convert this grid to a string with colors. Using strings.Builder instead of string concatenation keeps memory allocations sane - important when you’re doing this 12 times per second.\nLessons Learned Embedding is underrated. Shipping a single binary with all assets included is pure joy. No installers, no PATH issues, no “it works on my machine.”\nUnicode will bite you. We used []rune everywhere instead of string indexing. Runes properly handle multi-byte characters (emojis, CJK scripts, etc.). String indexing would break spectacularly on anything beyond ASCII.\nBubble Tea has a learning curve. The Elm Architecture feels foreign at first - every update returns a new state and commands. But once it clicks, building TUIs becomes genuinely fun.\nPerformance matters more than you think. We started at 60fps and immediately regretted it. 12fps (80ms) looks perfectly smooth for terminal animation and keeps the CPU happy.\nTry It Yourself # Clone and run git clone https://github.com/isopath/matrix.go cd matrix.go go run . # Or with options go run . --options # Or a specific file go run . --file your-text.txt The full code is on GitHub. Fork it, add your own text files, change the colors, make it yours. That’s the beauty of open source.\nWhat’s next? We’re thinking about image-to-ASCII with the same rain effect, or maybe a Star Wars crawl-style renderer. What would you build?\n","wordCount":"956","inLanguage":"en","datePublished":"2025-02-13T00:00:00Z","dateModified":"2025-02-13T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://isopath.github.io/posts/matrix-go/"},"publisher":{"@type":"Organization","name":"isopath","logo":{"@type":"ImageObject","url":"https://isopath.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://isopath.github.io/ accesskey=h title="isopath (Alt + H)">isopath</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://isopath.github.io/archives/ title=Archives><span>Archives</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">My new name is... Rain Man</h1><div class=post-description>Building a Matrix rain effect in the terminal using Go and Bubble Tea</div><div class=post-meta><span title='2025-02-13 00:00:00 +0000 UTC'>February 13, 2025</span></div></header><div class=post-content><p><img alt="Matrix Rain Demo" loading=lazy src=/matrix.gif></p><p>We got bored one weekend and decided to build a Matrix rain effect in the terminal. You know, those cascading green characters from the movie? But we wanted ours to display actual text files, not just random symbols. Here&rsquo;s how we built it.</p><h2 id=the-problem-with-shipping-assets>The Problem with Shipping Assets<a hidden class=anchor aria-hidden=true href=#the-problem-with-shipping-assets>#</a></h2><p>Building a terminal app is easy until you need to include data files. We had a bunch of text files we wanted to display, but asking users to download separate assets felt wrong. What if they put them in the wrong folder? What if they forgot entirely?</p><p>Go&rsquo;s <code>//go:embed</code> directive solves this beautifully. It lets you embed files directly into the compiled binary. No external dependencies, no &ldquo;file not found&rdquo; errors.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>//go:embed assets/*.txt</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>assetsFS</span> <span style=color:#a6e22e>embed</span>.<span style=color:#a6e22e>FS</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>readAsset</span>(<span style=color:#a6e22e>filename</span> <span style=color:#66d9ef>string</span>) (<span style=color:#66d9ef>string</span>, <span style=color:#66d9ef>error</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>data</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>assetsFS</span>.<span style=color:#a6e22e>ReadFile</span>(<span style=color:#a6e22e>filename</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;&#34;</span>, <span style=color:#a6e22e>err</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> string(<span style=color:#a6e22e>data</span>), <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Now our single binary contains everything. Ship it, run it, done.</p><h2 id=building-a-menu-that-doesnt-suck>Building a Menu That Doesn&rsquo;t Suck<a hidden class=anchor aria-hidden=true href=#building-a-menu-that-doesnt-suck>#</a></h2><p>We wanted users to pick which text file to rain-ify. Bubble Tea (Charm&rsquo;s TUI framework) makes this possible, but it&rsquo;s not exactly plug-and-play. The API requires you to jump through some hoops.</p><p>First, every list item needs to implement the <code>list.Item</code> interface. Go is strict about this - even if you don&rsquo;t use a feature, you still need to satisfy the interface:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>item</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>title</span>    <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>filename</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Required by list.Item, even though we disable filtering</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>i</span> <span style=color:#a6e22e>item</span>) <span style=color:#a6e22e>FilterValue</span>() <span style=color:#66d9ef>string</span> { 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;&#34;</span> 
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Then there&rsquo;s the delegate - the thing that actually renders each item. This is where you customize the look:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>itemDelegate</span> <span style=color:#66d9ef>struct</span>{}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>d</span> <span style=color:#a6e22e>itemDelegate</span>) <span style=color:#a6e22e>Render</span>(<span style=color:#a6e22e>w</span> <span style=color:#a6e22e>io</span>.<span style=color:#a6e22e>Writer</span>, <span style=color:#a6e22e>m</span> <span style=color:#a6e22e>list</span>.<span style=color:#a6e22e>Model</span>, <span style=color:#a6e22e>index</span> <span style=color:#66d9ef>int</span>, <span style=color:#a6e22e>listItem</span> <span style=color:#a6e22e>list</span>.<span style=color:#a6e22e>Item</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>ok</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>listItem</span>.(<span style=color:#a6e22e>item</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> !<span style=color:#a6e22e>ok</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>  <span style=color:#75715e>// Trust but verify</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>str</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Sprintf</span>(<span style=color:#e6db74>&#34;%d. %s&#34;</span>, <span style=color:#a6e22e>index</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>i</span>.<span style=color:#a6e22e>title</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>index</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>Index</span>() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprint</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>selectedItemStyle</span>.<span style=color:#a6e22e>Render</span>(<span style=color:#e6db74>&#34;&gt; &#34;</span><span style=color:#f92672>+</span><span style=color:#a6e22e>str</span>))
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprint</span>(<span style=color:#a6e22e>w</span>, <span style=color:#a6e22e>itemStyle</span>.<span style=color:#a6e22e>Render</span>(<span style=color:#a6e22e>str</span>))
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The type assertion <code>i, ok := listItem.(item)</code> is Go&rsquo;s way of saying &ldquo;I know what this should be, but prove it.&rdquo; It&rsquo;s defensive programming that prevents panics when types don&rsquo;t match.</p><h2 id=the-heartbeat-of-animation>The Heartbeat of Animation<a hidden class=anchor aria-hidden=true href=#the-heartbeat-of-animation>#</a></h2><p>Bubble Tea uses the Elm Architecture: your app has a Model (state), an Update function (handles messages), and a View function (renders output). Everything flows through messages.</p><p>For animation, we needed a timer. Enter <code>tea.Tick</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>tick</span>() <span style=color:#a6e22e>tea</span>.<span style=color:#a6e22e>Cmd</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>tea</span>.<span style=color:#a6e22e>Tick</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Millisecond</span><span style=color:#f92672>*</span><span style=color:#ae81ff>80</span>, <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>t</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Time</span>) <span style=color:#a6e22e>tea</span>.<span style=color:#a6e22e>Msg</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>tickMsg</span>(<span style=color:#a6e22e>t</span>)
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Every 80 milliseconds, this fires a message. Why 80ms? We tried 16ms (60fps) first, but the laptop fan sounded like a jet engine. 80ms is smooth enough to look good without melting your CPU.</p><p>The <code>Update</code> function catches these ticks and advances the animation:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>m</span> <span style=color:#a6e22e>model</span>) <span style=color:#a6e22e>Update</span>(<span style=color:#a6e22e>msg</span> <span style=color:#a6e22e>tea</span>.<span style=color:#a6e22e>Msg</span>) (<span style=color:#a6e22e>tea</span>.<span style=color:#a6e22e>Model</span>, <span style=color:#a6e22e>tea</span>.<span style=color:#a6e22e>Cmd</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>switch</span> <span style=color:#a6e22e>msg</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>msg</span>.(<span style=color:#66d9ef>type</span>) {
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>case</span> <span style=color:#a6e22e>tickMsg</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>viewing</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>updateColumns</span>()  <span style=color:#75715e>// Move the rain</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>m</span>, <span style=color:#a6e22e>tick</span>()   <span style=color:#75715e>// Schedule next frame</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ... handle other messages</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Notice how <code>tick()</code> returns itself? That&rsquo;s the recursive heartbeat. Each frame schedules the next one. Elegant once you wrap your head around it.</p><h2 id=making-it-rain>Making It Rain<a hidden class=anchor aria-hidden=true href=#making-it-rain>#</a></h2><p>The actual rain effect works by creating vertical columns of characters. Each column has a position, a height, and an offset into the source text:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>column</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>x</span>      <span style=color:#66d9ef>int</span> <span style=color:#75715e>// horizontal position  </span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>height</span> <span style=color:#66d9ef>int</span> <span style=color:#75715e>// how many characters</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>offset</span> <span style=color:#66d9ef>int</span> <span style=color:#75715e>// position in source text</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We calculate how many columns fit on screen (one every 2 characters for spacing), then randomize their starting positions:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>numCols</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>columns</span> = make([]<span style=color:#a6e22e>column</span>, <span style=color:#a6e22e>numCols</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>columns</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>columns</span>[<span style=color:#a6e22e>i</span>] = <span style=color:#a6e22e>column</span>{
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>x</span>:      <span style=color:#a6e22e>i</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>height</span>: <span style=color:#a6e22e>rand</span>.<span style=color:#a6e22e>Intn</span>(<span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>height</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>5</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>offset</span>: <span style=color:#a6e22e>rand</span>.<span style=color:#a6e22e>Intn</span>(len(<span style=color:#a6e22e>runes</span>)),
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Each frame, every column increments its offset. When it reaches the end of the text, it wraps back to zero. That&rsquo;s what creates the infinite scrolling effect. We also randomize heights occasionally - real rain isn&rsquo;t uniform, and neither should this be.</p><h2 id=the-view-from-above>The View from Above<a hidden class=anchor aria-hidden=true href=#the-view-from-above>#</a></h2><p>Rendering is the fun part. We build a 2D grid representing the terminal screen, fill it with spaces, then paint our rain columns:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>grid</span> <span style=color:#f92672>:=</span> make([][]<span style=color:#66d9ef>rune</span>, <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>height</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>grid</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>grid</span>[<span style=color:#a6e22e>i</span>] = make([]<span style=color:#66d9ef>rune</span>, <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>width</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>grid</span>[<span style=color:#a6e22e>i</span>] {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>grid</span>[<span style=color:#a6e22e>i</span>][<span style=color:#a6e22e>j</span>] = <span style=color:#e6db74>&#39; &#39;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Then we iterate through columns and place characters. The math <code>(col.offset + row) % len(runes)</code> wraps the text index so columns seamlessly loop through the content.</p><p>Finally, we convert this grid to a string with colors. Using <code>strings.Builder</code> instead of string concatenation keeps memory allocations sane - important when you&rsquo;re doing this 12 times per second.</p><h2 id=lessons-learned>Lessons Learned<a hidden class=anchor aria-hidden=true href=#lessons-learned>#</a></h2><p><strong>Embedding is underrated.</strong> Shipping a single binary with all assets included is pure joy. No installers, no PATH issues, no &ldquo;it works on my machine.&rdquo;</p><p><strong>Unicode will bite you.</strong> We used <code>[]rune</code> everywhere instead of <code>string</code> indexing. Runes properly handle multi-byte characters (emojis, CJK scripts, etc.). String indexing would break spectacularly on anything beyond ASCII.</p><p><strong>Bubble Tea has a learning curve.</strong> The Elm Architecture feels foreign at first - every update returns a new state and commands. But once it clicks, building TUIs becomes genuinely fun.</p><p><strong>Performance matters more than you think.</strong> We started at 60fps and immediately regretted it. 12fps (80ms) looks perfectly smooth for terminal animation and keeps the CPU happy.</p><h2 id=try-it-yourself>Try It Yourself<a hidden class=anchor aria-hidden=true href=#try-it-yourself>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Clone and run</span>
</span></span><span style=display:flex><span>git clone https://github.com/isopath/matrix.go
</span></span><span style=display:flex><span>cd matrix.go
</span></span><span style=display:flex><span>go run .
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Or with options</span>
</span></span><span style=display:flex><span>go run . --options
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Or a specific file</span>
</span></span><span style=display:flex><span>go run . --file your-text.txt
</span></span></code></pre></div><p>The full code is on GitHub. Fork it, add your own text files, change the colors, make it yours. That&rsquo;s the beauty of open source.</p><hr><p><strong>What&rsquo;s next?</strong> We&rsquo;re thinking about image-to-ASCII with the same rain effect, or maybe a Star Wars crawl-style renderer. What would you build?</p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://isopath.github.io/>isopath</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>